document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("posts-container"),t=document.getElementById("search"),n=document.querySelectorAll(".category-button"),o=document.getElementById("loading");let s=1,l="all",c="",d=!1,r=!1;e.addEventListener("click",(e=>{const t=e.target.closest(".post");if(!t)return;const n=t.querySelector(".post-link");n&&n.click()}));const a=t=>{const n=t._embedded?.["wp:featuredmedia"]?.[0]?.source_url||"",o=`\n            <div class="post">\n                <div class="post-info">\n                    <h2>\n                        <a class="post-link" href="${t.link}">\n                            ${t.title.rendered}\n                        </a>\n                    </h2>\n                    <p>${t.excerpt.rendered}</p>\n                </div>\n                <div class="post-img">\n                    ${n?`<img src="${n}" alt="${t.title.rendered}" />`:""}\n                </div>\n            </div>\n        `;e.insertAdjacentHTML("beforeend",o)},i=(t=!1)=>{if(d||r&&!1===t)return;d=!0,o.style.display="block",t&&(s=1,r=!1,e.innerHTML="");let n=`${"localhost"===location.hostname?"https://divinostelhados.com.br/":`${location.protocol}//${location.hostname}/`}wp-json/wp/v2/posts?_embed&per_page=8&page=${s}`;"all"!==l&&(n+=`&categories=${l}`),c.length>3&&(n+=`&search=${encodeURIComponent(c)}`),fetch(n).then((e=>e.ok?e.json():(r=!0,[]))).then((t=>{t.length?(t.forEach(a),s++,t.length<8&&(r=!0)):r=!0;const n=document.querySelectorAll(".post");console.log("posts",n),console.log("posts.lenght",n.length),0===n.length&&(html='<p id="not-found">Posts n√£o encontrados</p>',e.insertAdjacentHTML("beforeend",html))})).catch((e=>{console.error("Erro ao carregar posts:",e)})).finally((()=>{d=!1,o.style.display="none"}))};let p;n.forEach((e=>{e.addEventListener("click",(()=>{n.forEach((e=>e.classList.remove("active"))),e.classList.add("active"),l=e.dataset.id,i(!0)}))})),t.addEventListener("input",(()=>{clearTimeout(p),p=setTimeout((()=>{const e=t.value.trim();c=e,i(!0)}),400)})),window.addEventListener("scroll",(()=>{window.scrollY+window.innerHeight>=.75*document.body.scrollHeight&&i()})),i()}));